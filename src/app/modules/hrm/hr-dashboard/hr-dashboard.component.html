<div class="row">
  <div class="col-lg-6"><app-leave-approvals></app-leave-approvals></div>
  <!-- <div class="col-lg-6"><app-leave></app-leave></div> -->
</div>


<div class="generate_payslip">
  <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#payslip" > Generate Payslip</button>
</div>
<div class="modal fade" id="payslip" tabindex="-1" aria-labelledby="payslipLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <strong>Generate Payslip</strong>
      </div>
      <div class="modal-body ">
        <form [formGroup]="payslipForm" (ngSubmit)="onSubmit()">
          <div class="row mb-3">
            <div class="col-md-4">
              <label>Employee ID</label>
              <input type="number" formControlName="employeeId" class="form-control" placeholder="Enter Employee ID">
            </div>
            <div class="col-md-4">
              <label>CTC</label>
              <input type="number" formControlName="ctc" class="form-control" placeholder="Enter CTC">
            </div>
            <div class="col-md-4">
              <label>Other Allowance</label>
              <input type="number" formControlName="otherAllowance" class="form-control">
            </div>
          </div>

          <!-- Allowances -->
          <div class="card mb-3">
            <div class="card-header d-flex justify-content-between">
              <span>Allowances</span>
              <button type="button" class="btn btn-sm btn-primary" (click)="addAllowance()">+ Add</button>
            </div>
            <div class="card-body" formArrayName="allowances">
              <div class="row mb-2" *ngFor="let allowance of allowances.controls; let i=index" [formGroupName]="i">
                <div class="col-md-3"><input type="text" class="form-control" placeholder="Name" formControlName="name">
                </div>
                <div class="col-md-3"><input type="text" class="form-control" placeholder="Type" formControlName="type">
                </div>
                <div class="col-md-3"><input type="number" class="form-control" placeholder="Amount"
                    formControlName="amount" (input)="calculateTotals()">
                </div>
                <div class="col-md-3">
                  <button type="button" class="btn btn-sm btn-danger" (click)="removeAllowance(i)">
                    Remove
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Deductions -->
          <div class="card mb-3">
            <div class="card-header d-flex justify-content-between">
              <span>Deductions</span>
              <button type="button" class="btn btn-sm btn-primary" (click)="addDeduction()">+ Add</button>
            </div>
            <div class="card-body" formArrayName="deductions">
              <div class="row mb-2" *ngFor="let deduction of deductions.controls; let i=index" [formGroupName]="i">
                <div class="col-md-3"><input type="text" class="form-control" placeholder="Name" formControlName="name">
                </div>
                <div class="col-md-3"><input type="text" class="form-control" placeholder="Type" formControlName="type">
                </div>
                <div class="col-md-3"><input type="number" class="form-control" placeholder="Amount"
                    formControlName="amount" (input)="calculateTotals()">
                </div>
                <div class="col-md-3">
                  <button type="button" class="btn btn-sm btn-danger" (click)="removeDeduction(i)">
                    Remove
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Totals -->
          <div class="row mb-3">
            <div class="col-md-4">
              <label>Total Allowances</label>
              <input type="number" formControlName="total_Allowances" class="form-control" readonly>
            </div>
            <div class="col-md-4">
              <label>Total Deductions</label>
              <input type="number" formControlName="total_Deductions" class="form-control" readonly>
            </div>
            <div class="col-md-4">
              <label>Take Home Salary</label>
              <input type="number" formControlName="take_Home_Salary" class="form-control" readonly>
            </div>
          </div>

          <button type="submit" class="btn btn-success">Generate Payslip</button>
        </form>
      </div>
    </div>
  </div>
</div>


<div class="container mt-3">
  <div class="d-flex align-items-center gap-3 mb-3">
    <label class="fw-semibold">Employee:</label>
    <select class="form-select w-auto" [(ngModel)]="selectedEmployee" (change)="onEmployeeChange()">
      <option *ngFor="let e of employees" [value]="e.id">{{ e.name }}</option>
    </select>

    <div class="ms-auto d-flex gap-2">
      <button class="btn btn-outline-secondary btn-sm" (click)="prevMonth()">Prev</button>
      <button class="btn btn-outline-secondary btn-sm" (click)="today()">Today</button>
      <button class="btn btn-outline-secondary btn-sm" (click)="nextMonth()">Next</button>
    </div>
  </div>

  <div class="row g-4">
    <div class="col-lg-7">
      <div class="card">
        <div class="card-header fw-bold">Attendance Calendar</div>
        <div class="card-body">
          <mwl-calendar-month-view [viewDate]="viewDate" [events]="events">
          </mwl-calendar-month-view>
          <small class="text-muted">
            <span class="badge me-1" style="background:#28a745;">&nbsp;</span> Present
            <span class="badge ms-3 me-1" style="background:#dc3545;">&nbsp;</span> Absent
            <span class="badge ms-3 me-1" style="background:#fd7e14;">&nbsp;</span> Delayed
            <span class="badge ms-3 me-1" style="background:#0d6efd;">&nbsp;</span> Leave
          </small>
        </div>
      </div>
    </div>

    <div class="col-lg-5">
      <div class="card h-100">
        <div class="card-header fw-bold">Monthly Attendance</div>
        <div class="card-body">
          <canvas baseChart [data]="barChartData" [options]="barChartOptions" type="bar">
          </canvas>
        </div>
      </div>
    </div>
  </div>
</div>


<!-- 

<div class="dashboard">
  <div class="row d-flex flex-row justify-content-between">
    <div class=" profile">
      <div class="employee grid-cols-6 rounded-2xl shadow-md p-6 d-flex items-center justify-between">
        <div>
          <img src="../../../../assets/img/profile-img.jpg" style="width: 75px;" alt="profile" class="rounded-circle" />
        </div>
        <div class="ml-2">
          <h2 class="text-xl font-bold">Venkat</h2>
          <p class="text-gray-500"> Manager</p>
        </div>
      </div>
    </div>
    <div class="row d-flex flex-row details ">
      <div class="details_brief">
        <h5>Salary</h5>
        <p>RS.10000</p>
      </div>
      <div class="details_brief">
        <h5>Recruiter</h5>
        <p>10000</p>
      </div>
      <div class="details_brief">
        <h5>Application</h5>
        <p>10000</p>
      </div>
      <div class="details_brief">
        <h5>Department</h5>
        <p>10000</p>
      </div>
      <div class="details_brief">
        <h5>Location</h5>
        <p>10000</p>
      </div>
      <div class="details_brief">
        <h5>Employment</h5>
        <p>10000</p>
      </div>
    </div>
  </div>

  <div class="d-flex flex-row mt-2">
    <div class="col-md-6 stat-card big">
      <canvas id="pieChart"></canvas>
    </div>

    <canvas id="attendanceChart"></canvas>
    <div class="filter-buttons d-flex flex-column g-2">
      <button (click)="changeFilter('daily')" [class.active]="filterType === 'daily'">Daily</button>
      <button (click)="changeFilter('monthly')" [class.active]="filterType === 'monthly'">Monthly</button>
      <button (click)="changeFilter('yearly')" [class.active]="filterType === 'yearly'">Yearly</button>
    </div>
  </div>
  <div class="stats-row mt-2">
    <div class="stat-cards " *ngFor="let item of [
        {label:'Checked In',value:stats.checkedIn,color:'#4da3ff'},
        {label:'Not Checked In',value:stats.notCheckedIn,color:'#ff5c5c'},
        {label:'On Leave',value:stats.onLeave,color:'#4caf50'},
        {label:'Weekly Off',value:stats.weeklyOff,color:'#999'},
        {label:'Holiday',value:stats.holiday,color:'#ff9800'},
        {label:'Checked Out',value:stats.checkedOut,color:'#ffca28'}
      ]" [style.borderColor]="item.color">
      <h4>{{ item.label }}</h4>
      <p>{{ item.value }}</p>
    </div>
  </div>
</div> -->